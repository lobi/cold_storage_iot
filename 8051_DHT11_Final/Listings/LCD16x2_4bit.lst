C51 COMPILER V9.60.7.0   LCD16X2_4BIT                                                      09/22/2024 15:04:44 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD16X2_4BIT
OBJECT MODULE PLACED IN .\Objects\LCD16x2_4bit.obj
COMPILER INVOKED BY: G:\Program\Keil_v5\C51\BIN\C51.EXE LCD16x2_4bit.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\LCD16x2_4bit.lst) TABS(2) OBJECT(.\Objects\LCD16x2_4bit.obj)

line level    source

   1          /*
   2           * DHT11 Interfacing with 8051
   3           * http://www.electronicwings.com
   4           */
   5          
   6          
   7          #include<reg52.h>
   8          #include<stdio.h>
   9          #include<string.h>
  10          #include <stdlib.h>
  11          #include "LCD16x2_4bit.h"
  12          sbit DHT11=P3^7;    /* Connect DHT11 Sensor Pin to P2.1 Pin */
  13          int I_RH,D_RH,I_Temp,D_Temp,CheckSum; 
  14          
  15          void timer_delay20ms()    /* Timer0 delay function */
  16          {
  17   1        TMOD = 0x01;
  18   1        TH0 = 0xB8;       /* Load higher 8-bit in TH0 */
  19   1        TL0 = 0x0C;       /* Load lower 8-bit in TL0 */
  20   1        TR0 = 1;          /* Start timer0 */
  21   1        while(TF0 == 0);  /* Wait until timer0 flag set */
  22   1        TR0 = 0;          /* Stop timer0 */
  23   1        TF0 = 0;          /* Clear timer0 flag */
  24   1      }
  25          
  26          void timer_delay30us() /* Timer0 delay function */
  27          {
  28   1        TMOD = 0x01;      /* Timer0 mode1 (16-bit timer mode) */
  29   1        TH0 = 0xFF;       /* Load higher 8-bit in TH0 */
  30   1        TL0 = 0xF1;       /* Load lower 8-bit in TL0 */
  31   1        TR0 = 1;          /* Start timer0 */
  32   1        while(TF0 == 0);  /* Wait until timer0 flag set */
  33   1        TR0 = 0;          /* Stop timer0 */
  34   1        TF0 = 0;          /* Clear timer0 flag */
  35   1      }
  36          
  37          void Request()      /* Microcontroller send start pulse or request */
  38          {
  39   1        DHT11 = 0;        /* set to low pin */
  40   1        timer_delay20ms();/* wait for 20ms */
  41   1        DHT11 = 1;        /* set to high pin */
  42   1      }
  43          
  44          void Response()     /* receive response from DHT11 */
  45          {
  46   1        while(DHT11==1);
  47   1        while(DHT11==0);
  48   1        while(DHT11==1);
  49   1      }
  50          
  51          int Receive_data()      /* receive data */
  52          {
  53   1        int q,c=0;  
  54   1        for (q=0; q<8; q++)
C51 COMPILER V9.60.7.0   LCD16X2_4BIT                                                      09/22/2024 15:04:44 PAGE 2   

  55   1        {
  56   2          while(DHT11==0);    /* check received bit 0 or 1 */
  57   2          timer_delay30us();
  58   2          if(DHT11 == 1)      /* if high pulse is greater than 30ms */
  59   2          c = (c<<1)|(0x01);  /* then its logic HIGH */
  60   2          
  61   2          else                /* otherwise its logic LOW */
  62   2          c = (c<<1);
  63   2          
  64   2          while(DHT11==1);
  65   2        }
  66   1        return c;
  67   1      }
  68          
  69          void main()
  70          {
  71   1        unsigned char dat[20];
  72   1        LCD_Init();               /* initialize LCD */
  73   1        
  74   1      while(1)
  75   1        {   
  76   2          Request();              /* send start pulse */
  77   2          Response();             /* receive response */
  78   2          
  79   2          I_RH=Receive_data();    /* store first eight bit in I_RH */   
  80   2          D_RH=Receive_data();    /* store next eight bit in D_RH */  
  81   2          I_Temp=Receive_data();  /* store next eight bit in I_Temp */
  82   2          D_Temp=Receive_data();  /* store next eight bit in D_Temp */
  83   2          CheckSum=Receive_data();/* store next eight bit in CheckSum */
  84   2      
  85   2          if ((I_RH + D_RH + I_Temp + D_Temp) != CheckSum)
  86   2          {
  87   3            LCD_String_xy(0,0,"Error");
  88   3          }
  89   2          
  90   2          else
  91   2          {
  92   3            sprintf(dat,"Hum = %d.%d",I_RH,D_RH);
  93   3            LCD_String_xy(0,0,dat);
  94   3            sprintf(dat,"Tem = %d.%d",I_Temp,D_Temp);   
  95   3            LCD_String_xy(1,0,dat);
  96   3            LCD_Char(0xDF);
  97   3            LCD_String("C");
  98   3            memset(dat,0,20);
  99   3            sprintf(dat,"%d   ",CheckSum);
 100   3            LCD_String_xy(1,13,dat);
 101   3          }   
 102   2          delay(100);
 103   2        } 
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    599    ----
   CONSTANT SIZE    =     38    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10      30
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
